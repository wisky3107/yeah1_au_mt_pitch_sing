"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.floatWindowsLogic = void 0;
const vue_js_1 = require("vue/dist/vue.js");
const float_window_1 = require("./components/float-window");
const shader_graph_1 = require("../../shader-graph");
const vue_1 = require("vue");
const floatWindowsLogic = (props, ctx) => {
    const tabRefs = (0, vue_js_1.ref)([]);
    const floatWindowRefs = (0, vue_js_1.ref)([]);
    const pressTabRefs = new Map();
    const floatWindowMap = (0, float_window_1.getFloatWindowMap)();
    const floatWindowConfigList = (0, vue_js_1.ref)([]);
    function onFloatWindowConfigChanged() {
        (0, float_window_1.updateFloatWindowConfigs)().then((configs) => {
            floatWindowConfigList.value = configs;
        });
    }
    shader_graph_1.MessageMgr.Instance.register(shader_graph_1.MessageType.AssetLoaded, () => {
        initFloatWindowConfigs();
    });
    (0, vue_js_1.onMounted)(() => {
        shader_graph_1.MessageMgr.Instance.register([
            shader_graph_1.MessageType.FloatWindowConfigChanged,
        ], onFloatWindowConfigChanged);
    });
    (0, vue_js_1.onUnmounted)(() => {
        shader_graph_1.MessageMgr.Instance.unregister([
            shader_graph_1.MessageType.FloatWindowConfigChanged,
        ], onFloatWindowConfigChanged);
    });
    function getFloatWindowByKey(key) {
        return floatWindowMap.get(key) ?? undefined;
    }
    function initFloatWindowConfigs() {
        (0, float_window_1.updateFloatWindowConfigs)().then((configs) => {
            floatWindowConfigList.value = configs;
            (0, vue_1.nextTick)(() => {
                floatWindowRefs.value.forEach((floatWindowRef) => {
                    shader_graph_1.GraphConfigMgr.Instance.addFloatWindow(floatWindowRef.config.key, floatWindowRef.$el);
                });
                floatWindowConfigList.value.forEach((config, index) => {
                    if (config.base.defaultShow || config.details?.show) {
                        pressTab(tabRefs.value[index], floatWindowRefs.value[index], config.key);
                    }
                    else {
                        releaseTab(floatWindowRefs.value[index]);
                    }
                });
            });
        });
    }
    function pressTab(tabRef, floatWindowRef, key) {
        if (tabRef && floatWindowRef) {
            floatWindowRef.show();
            pressTabRefs.set(key, tabRef);
            tabRef.setAttribute('pressed', '');
        }
    }
    function releaseTab(floatWindowRef) {
        floatWindowRef.hide();
        onHideFloatWindow(floatWindowRef.config.key);
    }
    ///// 右边 tab 菜单
    function togglePressTab(key, index) {
        // 当前按下的 tab
        const tabRef = tabRefs.value[index];
        const floatWindowRef = floatWindowRefs.value[index];
        if (tabRef && floatWindowRef) {
            if (tabRef.getAttribute('pressed') !== null) {
                releaseTab(floatWindowRef);
            }
            else {
                pressTab(tabRef, floatWindowRef, key);
            }
        }
    }
    function getStyle(tab) {
        const style = {};
        if (tab.height !== undefined) {
            style.height = tab.height + 'px';
        }
        return style;
    }
    function onHideFloatWindow(key) {
        const tabRef = pressTabRefs.get(key);
        if (tabRef) {
            tabRef.removeAttribute('pressed');
            pressTabRefs.delete(key);
        }
    }
    /////
    return {
        tabRefs,
        floatWindowRefs,
        floatWindowConfigList,
        onHideFloatWindow,
        togglePressTab,
        getFloatWindowByKey,
        getStyle,
    };
};
exports.floatWindowsLogic = floatWindowsLogic;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmxvYXQtd2luZG93cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wYW5lbHMvc2hhZGVyLWdyYXBoL2Zsb2F0LXdpbmRvd3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsNENBQThEO0FBRTlELDREQU1tQztBQUNuQyxxREFBNkU7QUFDN0UsNkJBQStCO0FBRXhCLE1BQU0saUJBQWlCLEdBQUcsQ0FBQyxLQUFVLEVBQUUsR0FBcUMsRUFBRSxFQUFFO0lBQ25GLE1BQU0sT0FBTyxHQUFHLElBQUEsWUFBRyxFQUFnQixFQUFFLENBQUMsQ0FBQztJQUN2QyxNQUFNLGVBQWUsR0FBRyxJQUFBLFlBQUcsRUFBdUIsRUFBRSxDQUFDLENBQUM7SUFDdEQsTUFBTSxZQUFZLEdBQTZCLElBQUksR0FBRyxFQUFFLENBQUM7SUFDekQsTUFBTSxjQUFjLEdBQUcsSUFBQSxnQ0FBaUIsR0FBRSxDQUFDO0lBQzNDLE1BQU0scUJBQXFCLEdBQUcsSUFBQSxZQUFHLEVBQXNCLEVBQUUsQ0FBQyxDQUFDO0lBRTNELFNBQVMsMEJBQTBCO1FBQy9CLElBQUEsdUNBQXdCLEdBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUE0QixFQUFFLEVBQUU7WUFDN0QscUJBQXFCLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztRQUMxQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCx5QkFBVSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsMEJBQVcsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1FBQ3ZELHNCQUFzQixFQUFFLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFBLGtCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ1gseUJBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO1lBQ3pCLDBCQUFXLENBQUMsd0JBQXdCO1NBQ3ZDLEVBQUUsMEJBQTBCLENBQUMsQ0FBQztJQUNuQyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUEs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RyxJQUFJLENBQUM7U0FDcEM7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsU0FBUyxpQkFBaUIsQ0FBQyxHQUFXO1FBQ2xDLE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckMsSUFBSSxNQUFNLEVBQUU7WUFDUixNQUFNLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ2xDLFlBQVksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDNUI7SUFDTCxDQUFDO0lBQ0QsS0FBSztJQUVMLE9BQU87UUFDSCxPQUFPO1FBQ1AsZUFBZTtRQUNmLHFCQUFxQjtRQUVyQixpQkFBaUI7UUFDakIsY0FBYztRQUNkLG1CQUFtQjtRQUVuQixRQUFRO0tBQ1gsQ0FBQztBQUNOLENBQUMsQ0FBQztBQTNHVyxRQUFBLGlCQUFpQixxQkEyRzVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2V0dXBDb250ZXh0IH0gZnJvbSAndnVlL3R5cGVzL3YzLXNldHVwLWNvbnRleHQnO1xuaW1wb3J0IHsgcmVmLCBvbk1vdW50ZWQsIG9uVW5tb3VudGVkIH0gZnJvbSAndnVlL2Rpc3QvdnVlLmpzJztcblxuaW1wb3J0IHtcbiAgICBGbG9hdFdpbmRvdyxcbiAgICBGbG9hdFdpbmRvd0NvbmZpZyxcbiAgICBGbG9hdFdpbmRvd1RhYixcbiAgICBnZXRGbG9hdFdpbmRvd01hcCxcbiAgICB1cGRhdGVGbG9hdFdpbmRvd0NvbmZpZ3MsXG59IGZyb20gJy4vY29tcG9uZW50cy9mbG9hdC13aW5kb3cnO1xuaW1wb3J0IHsgR3JhcGhDb25maWdNZ3IsIE1lc3NhZ2VNZ3IsIE1lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vLi4vc2hhZGVyLWdyYXBoJztcbmltcG9ydCB7IG5leHRUaWNrIH0gZnJvbSAndnVlJztcblxuZXhwb3J0IGNvbnN0IGZsb2F0V2luZG93c0xvZ2ljID0gKHByb3BzOiB7IH0sIGN0eDogU2V0dXBDb250ZXh0IHwgU2V0dXBDb250ZXh0PGFueT4pID0+IHtcbiAgICBjb25zdCB0YWJSZWZzID0gcmVmPEhUTUxFbGVtZW50W10+KFtdKTtcbiAgICBjb25zdCBmbG9hdFdpbmRvd1JlZnMgPSByZWY8dHlwZW9mIEZsb2F0V2luZG93W10+KFtdKTtcbiAgICBjb25zdCBwcmVzc1RhYlJlZnM6IE1hcDxzdHJpbmcsIEhUTUxFbGVtZW50PiA9IG5ldyBNYXAoKTtcbiAgICBjb25zdCBmbG9hdFdpbmRvd01hcCA9IGdldEZsb2F0V2luZG93TWFwKCk7XG4gICAgY29uc3QgZmxvYXRXaW5kb3dDb25maWdMaXN0ID0gcmVmPEZsb2F0V2luZG93Q29uZmlnW10+KFtdKTtcblxuICAgIGZ1bmN0aW9uIG9uRmxvYXRXaW5kb3dDb25maWdDaGFuZ2VkKCkge1xuICAgICAgICB1cGRhdGVGbG9hdFdpbmRvd0NvbmZpZ3MoKS50aGVuKChjb25maWdzOiBGbG9hdFdpbmRvd0NvbmZpZ1tdKSA9PiB7XG4gICAgICAgICAgICBmbG9hdFdpbmRvd0NvbmZpZ0xpc3QudmFsdWUgPSBjb25maWdzO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBNZXNzYWdlTWdyLkluc3RhbmNlLnJlZ2lzdGVyKE1lc3NhZ2VUeXBlLkFzc2V0TG9hZGVkLCAoKSA9PiB7XG4gICAgICAgIGluaXRGbG9hdFdpbmRvd0NvbmZpZ3MoKTtcbiAgICB9KTtcblxuICAgIG9uTW91bnRlZCgoKSA9PiB7XG4gICAgICAgIE1lc3NhZ2VNZ3IuSW5zdGFuY2UucmVnaXN0ZXIoW1xuICAgICAgICAgICAgTWVzc2FnZVR5cGUuRmxvYXRXaW5kb3dDb25maWdDaGFuZ2VkLFxuICAgICAgICBdLCBvbkZsb2F0V2luZG93Q29uZmlnQ2hhbmdlZCk7XG4gICAgfSk7XG5cbiAgICBvblVubW91bnRlZCgoKSA9PiB7XG4gICAgICAgIE1lc3NhZ2VNZ3IuSW5zdGFuY2UudW5yZWdpc3RlcihbXG4gICAgICAgICAgICBNZXNzYWdlVHlwZS5GbG9hdFdpbmRvd0NvbmZpZ0NoYW5nZWQsXG4gICAgICAgIF0sIG9uRmxvYXRXaW5kb3dDb25maWdDaGFuZ2VkKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGdldEZsb2F0V2luZG93QnlLZXkoa2V5OiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGZsb2F0V2luZG93TWFwLmdldChrZXkpID8/IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0RmxvYXRXaW5kb3dDb25maWdzKCkge1xuICAgICAgICB1cGRhdGVGbG9hdFdpbmRvd0NvbmZpZ3MoKS50aGVuKChjb25maWdzOiBGbG9hdFdpbmRvd0NvbmZpZ1tdKSA9PiB7XG4gICAgICAgICAgICBmbG9hdFdpbmRvd0NvbmZpZ0xpc3QudmFsdWUgPSBjb25maWdzO1xuXG4gICAgICAgICAgICBuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgZmxvYXRXaW5kb3dSZWZzLnZhbHVlLmZvckVhY2goKGZsb2F0V2luZG93UmVmKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIEdyYXBoQ29uZmlnTWdyLkluc3RhbmNlLmFkZEZsb2F0V2luZG93KGZsb2F0V2luZG93UmVmLmNvbmZpZy5rZXksIGZsb2F0V2luZG93UmVmLiRlbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZmxvYXRXaW5kb3dDb25maWdMaXN0LnZhbHVlLmZvckVhY2goKGNvbmZpZywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5iYXNlLmRlZmF1bHRTaG93IHx8IGNvbmZpZy5kZXRhaWxzPy5zaG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVzc1RhYih0YWJSZWZzLnZhbHVlW2luZGV4XSwgZmxvYXRXaW5kb3dSZWZzLnZhbHVlW2luZGV4XSwgY29uZmlnLmtleSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxlYXNlVGFiKGZsb2F0V2luZG93UmVmcy52YWx1ZVtpbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJlc3NUYWIodGFiUmVmOiBIVE1MRWxlbWVudCwgZmxvYXRXaW5kb3dSZWY6IHR5cGVvZiBGbG9hdFdpbmRvdywga2V5OiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRhYlJlZiAmJiBmbG9hdFdpbmRvd1JlZikge1xuICAgICAgICAgICAgZmxvYXRXaW5kb3dSZWYuc2hvdygpO1xuICAgICAgICAgICAgcHJlc3NUYWJSZWZzLnNldChrZXksIHRhYlJlZik7XG4gICAgICAgICAgICB0YWJSZWYuc2V0QXR0cmlidXRlKCdwcmVzc2VkJywgJycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVsZWFzZVRhYihmbG9hdFdpbmRvd1JlZjogdHlwZW9mIEZsb2F0V2luZG93KSB7XG4gICAgICAgIGZsb2F0V2luZG93UmVmLmhpZGUoKTtcbiAgICAgICAgb25IaWRlRmxvYXRXaW5kb3coZmxvYXRXaW5kb3dSZWYuY29uZmlnLmtleSk7XG4gICAgfVxuXG4gICAgLy8vLy8g5Y+z6L65IHRhYiDoj5zljZVcbiAgICBmdW5jdGlvbiB0b2dnbGVQcmVzc1RhYihrZXk6IHN0cmluZywgaW5kZXg6IG51bWJlcikge1xuICAgICAgICAvLyDlvZPliY3mjInkuIvnmoQgdGFiXG4gICAgICAgIGNvbnN0IHRhYlJlZiA9IHRhYlJlZnMudmFsdWVbaW5kZXhdO1xuICAgICAgICBjb25zdCBmbG9hdFdpbmRvd1JlZiA9IGZsb2F0V2luZG93UmVmcy52YWx1ZVtpbmRleF07XG4gICAgICAgIGlmICh0YWJSZWYgJiYgZmxvYXRXaW5kb3dSZWYpIHtcbiAgICAgICAgICAgIGlmICh0YWJSZWYuZ2V0QXR0cmlidXRlKCdwcmVzc2VkJykgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZWxlYXNlVGFiKGZsb2F0V2luZG93UmVmKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJlc3NUYWIodGFiUmVmLCBmbG9hdFdpbmRvd1JlZiwga2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0eWxlKHRhYjogRmxvYXRXaW5kb3dUYWIpIHtcbiAgICAgICAgY29uc3Qgc3R5bGU6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgICAgaWYgKHRhYi5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3R5bGUuaGVpZ2h0ID0gdGFiLmhlaWdodCArICdweCc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0eWxlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uSGlkZUZsb2F0V2luZG93KGtleTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHRhYlJlZiA9IHByZXNzVGFiUmVmcy5nZXQoa2V5KTtcbiAgICAgICAgaWYgKHRhYlJlZikge1xuICAgICAgICAgICAgdGFiUmVmLnJlbW92ZUF0dHJpYnV0ZSgncHJlc3NlZCcpO1xuICAgICAgICAgICAgcHJlc3NUYWJSZWZzLmRlbGV0ZShrZXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vLy8vXG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0YWJSZWZzLFxuICAgICAgICBmbG9hdFdpbmRvd1JlZnMsXG4gICAgICAgIGZsb2F0V2luZG93Q29uZmlnTGlzdCxcblxuICAgICAgICBvbkhpZGVGbG9hdFdpbmRvdyxcbiAgICAgICAgdG9nZ2xlUHJlc3NUYWIsXG4gICAgICAgIGdldEZsb2F0V2luZG93QnlLZXksXG5cbiAgICAgICAgZ2V0U3R5bGUsXG4gICAgfTtcbn07XG4iXX0=