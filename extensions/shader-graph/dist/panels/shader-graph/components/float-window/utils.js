"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.convertMenuData = exports.filterMenuByKeyword = exports.getTitleBarHeight = exports.getBoundingClientRect = exports.validatePosition = void 0;
function validatePosition(position) {
    return !(!position || ((position.left !== undefined && position.left === '') ||
        (position.right !== undefined && position.right === '') ||
        (position.top !== undefined && position.top === '') ||
        (position.bottom !== undefined && position.bottom === '')));
}
exports.validatePosition = validatePosition;
function getBoundingClientRect(target) {
    if (document.body.getAttribute('name') === 'sub') {
        return {
            left: target.clientLeft,
            right: target.clientLeft + target.clientWidth,
            top: target.clientTop,
            bottom: target.clientTop + target.clientHeight,
            width: target.clientWidth,
            height: target.clientHeight,
        };
    }
    return target.getBoundingClientRect();
}
exports.getBoundingClientRect = getBoundingClientRect;
/**
 * 获取 title bar 的高度
 */
function getTitleBarHeight() {
    let titleBarHeight = 25; // 系统 titleBar 的高度
    if (document.body.getAttribute('name') === 'sub') {
        // 窗口 title 的高度
        titleBarHeight += 50;
    }
    return titleBarHeight;
}
exports.getTitleBarHeight = getTitleBarHeight;
function filterMenuByKeyword(tree, keyword) {
    const result = {
        firstSelect: null,
        filterTree: [],
    };
    const keywordLowerCase = keyword.toLowerCase();
    function filterRecursive(menuItems) {
        for (const item of menuItems) {
            item.show = false;
            const text = item.detail.value.toLowerCase();
            if (item.children.length === 0 &&
                (text.startsWith(keywordLowerCase) || text.includes(keywordLowerCase))) {
                item.show = true;
                let target = item.parent;
                while (target) {
                    if (target.show)
                        break;
                    target.show = true;
                    target = target.parent;
                }
            }
            if (item.children && item.children.length > 0) {
                filterRecursive(item.children);
            }
        }
    }
    filterRecursive(tree);
    const list = [];
    function filterItems(menuItems) {
        menuItems = menuItems.filter((item) => {
            if (item.show && item.children.length === 0) {
                list.push(item);
            }
            return item.show;
        });
        for (const menuItem of menuItems) {
            menuItem.children = filterItems(menuItem.children);
        }
        return menuItems;
    }
    return {
        filterTree: filterItems(tree),
        firstSelect: list[0],
    };
}
exports.filterMenuByKeyword = filterMenuByKeyword;
function convertMenuData(menuData, fold, parent) {
    return menuData.map((item) => {
        const submenu = item.submenu || [];
        const itemMenu = {
            parent: parent || null,
            detail: {
                addOptions: item.addOptions,
                value: item.label,
            },
            show: true,
            fold: fold,
            showArrow: submenu.length > 0,
            children: [],
        };
        itemMenu.children = convertMenuData(submenu, fold, itemMenu);
        return itemMenu;
    });
}
exports.convertMenuData = convertMenuData;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvcGFuZWxzL3NoYWRlci1ncmFwaC9jb21wb25lbnRzL2Zsb2F0LXdpbmRvdy91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFjQSxTQUFnQixnQkFBZ0IsQ0FBQyxRQUE0RTtJQUN6RyxPQUFPLENBQUMsQ0FBQyxDQUFDLFFBQVEsSUFBSSxDQUNsQixDQUFDLFFBQVEsQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3JELENBQUMsUUFBUSxDQUFDLEtBQUssS0FBSyxTQUFTLElBQUksUUFBUSxDQUFDLEtBQUssS0FBSyxFQUFFLENBQUM7UUFDdkQsQ0FBQyxRQUFRLENBQUMsR0FBRyxLQUFLLFNBQVMsSUFBSSxRQUFRLENBQUMsR0FBRyxLQUFLLEVBQUUsQ0FBQztRQUNuRCxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssU0FBUyxJQUFJLFFBQVEsQ0FBQyxNQUFNLEtBQUssRUFBRSxDQUFDLENBQzVELENBQUMsQ0FBQztBQUNQLENBQUM7QUFQRCw0Q0FPQztBQUVELFNBQWdCLHFCQUFxQixDQUFDLE1BQW1CO0lBQ3JELElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssS0FBSyxFQUFFO1FBQzlDLE9BQU87WUFDSCxJQUFJLEVBQUUsTUFBTSxDQUFDLFVBQVU7WUFDdkIsS0FBSyxFQUFFLE1BQU0sQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLFdBQVc7WUFDN0MsR0FBRyxFQUFFLE1BQU0sQ0FBQyxTQUFTO1lBQ3JCLE1BQU0sRUFBRSxNQUFNLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxZQUFZO1lBQzlDLEtBQUssRUFBRSxNQUFNLENBQUMsV0FBVztZQUN6QixNQUFNLEVBQUUsTUFBTSxDQUFDLFlBQVk7U0FDOUIsQ0FBQztLQUNMO0lBQ0QsT0FB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LENBQUM7UUFDbkMsTUFBTSxRQUFRLEdBQWE7WUFDdkIsTUFBTSxFQUFFLE1BQU0sSUFBSSxJQUFJO1lBQ3RCLE1BQU0sRUFBRTtnQkFDSixVQUFVLEVBQUUsSUFBSSxDQUFDLFVBQVc7Z0JBQzVCLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBTTthQUNyQjtZQUNELElBQUksRUFBRSxJQUFJO1lBQ1YsSUFBSSxFQUFFLElBQUk7WUFDVixTQUFTLEVBQUUsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDO1lBQzdCLFFBQVEsRUFBRSxFQUFFO1NBQ2YsQ0FBQztRQUNGLFFBQVEsQ0FBQyxRQUFRLEdBQUcsZUFBZSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDN0QsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBakJELDBDQWlCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdyYXBoRWRpdG9yQWRkT3B0aW9ucywgTWVudVRlbXBsYXRlSXRlbSB9IGZyb20gJy4uLy4uLy4uLy4uL3NoYWRlci1ncmFwaCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJlZURhdGEge1xuICAgIHBhcmVudDogVHJlZURhdGEgfCBudWxsLFxuICAgIGRldGFpbDoge1xuICAgICAgICBhZGRPcHRpb25zOiBHcmFwaEVkaXRvckFkZE9wdGlvbnMsXG4gICAgICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgfSxcbiAgICBzaG93OiBib29sZWFuLFxuICAgIGZvbGQ6IGJvb2xlYW4sXG4gICAgc2hvd0Fycm93OiBib29sZWFuLFxuICAgIGNoaWxkcmVuOiBUcmVlRGF0YVtdLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQb3NpdGlvbihwb3NpdGlvbj86IHsgdG9wPzogc3RyaW5nOyByaWdodD86IHN0cmluZzsgbGVmdD86IHN0cmluZzsgYm90dG9tPzogc3RyaW5nOyB9KSB7XG4gICAgcmV0dXJuICEoIXBvc2l0aW9uIHx8IChcbiAgICAgICAgKHBvc2l0aW9uLmxlZnQgIT09IHVuZGVmaW5lZCAmJiBwb3NpdGlvbi5sZWZ0ID09PSAnJykgfHxcbiAgICAgICAgKHBvc2l0aW9uLnJpZ2h0ICE9PSB1bmRlZmluZWQgJiYgcG9zaXRpb24ucmlnaHQgPT09ICcnKSB8fFxuICAgICAgICAocG9zaXRpb24udG9wICE9PSB1bmRlZmluZWQgJiYgcG9zaXRpb24udG9wID09PSAnJykgfHxcbiAgICAgICAgKHBvc2l0aW9uLmJvdHRvbSAhPT0gdW5kZWZpbmVkICYmIHBvc2l0aW9uLmJvdHRvbSA9PT0gJycpXG4gICAgKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3QodGFyZ2V0OiBIVE1MRWxlbWVudCkge1xuICAgIGlmIChkb2N1bWVudC5ib2R5LmdldEF0dHJpYnV0ZSgnbmFtZScpID09PSAnc3ViJykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGVmdDogdGFyZ2V0LmNsaWVudExlZnQsXG4gICAgICAgICAgICByaWdodDogdGFyZ2V0LmNsaWVudExlZnQgKyB0YXJnZXQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICB0b3A6IHRhcmdldC5jbGllbnRUb3AsXG4gICAgICAgICAgICBib3R0b206IHRhcmdldC5jbGllbnRUb3AgKyB0YXJnZXQuY2xpZW50SGVpZ2h0LFxuICAgICAgICAgICAgd2lkdGg6IHRhcmdldC5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogdGFyZ2V0LmNsaWVudEhlaWdodCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbn1cblxuLyoqXG4gKiDojrflj5YgdGl0bGUgYmFyIOeahOmrmOW6plxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGl0bGVCYXJIZWlnaHQoKSB7XG4gICAgbGV0IHRpdGxlQmFySGVpZ2h0ID0gMjU7Ly8g57O757ufIHRpdGxlQmFyIOeahOmrmOW6plxuICAgIGlmIChkb2N1bWVudC5ib2R5LmdldEF0dHJpYnV0ZSgnbmFtZScpID09PSAnc3ViJykge1xuICAgICAgICAvLyDnqpflj6MgdGl0bGUg55qE6auY5bqmXG4gICAgICAgIHRpdGxlQmFySGVpZ2h0ICs9IDUwO1xuICAgIH1cbiAgICByZXR1cm4gdGl0bGVCYXJIZWlnaHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJNZW51QnlLZXl3b3JkKHRyZWU6IFRyZWVEYXRhW10sIGtleXdvcmQ6IHN0cmluZyk6IHsgZmlyc3RTZWxlY3Q6IFRyZWVEYXRhIHwgbnVsbCwgZmlsdGVyVHJlZTogVHJlZURhdGFbXSB9IHtcbiAgICBjb25zdCByZXN1bHQ6IHsgZmlyc3RTZWxlY3Q6IFRyZWVEYXRhIHwgbnVsbCwgZmlsdGVyVHJlZTogVHJlZURhdGFbXSB9ID0ge1xuICAgICAgICBmaXJzdFNlbGVjdDogbnVsbCxcbiAgICAgICAgZmlsdGVyVHJlZTogW10sXG4gICAgfTtcblxuICAgIGNvbnN0IGtleXdvcmRMb3dlckNhc2UgPSBrZXl3b3JkLnRvTG93ZXJDYXNlKCk7XG4gICAgZnVuY3Rpb24gZmlsdGVyUmVjdXJzaXZlKG1lbnVJdGVtczogVHJlZURhdGFbXSkge1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbWVudUl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtLnNob3cgPSBmYWxzZTtcblxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IGl0ZW0uZGV0YWlsLnZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbi5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICAodGV4dC5zdGFydHNXaXRoKGtleXdvcmRMb3dlckNhc2UpIHx8IHRleHQuaW5jbHVkZXMoa2V5d29yZExvd2VyQ2FzZSkpKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5zaG93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gaXRlbS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LnNob3cpIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc2hvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyUmVjdXJzaXZlKGl0ZW0uY2hpbGRyZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZmlsdGVyUmVjdXJzaXZlKHRyZWUpO1xuXG4gICAgY29uc3QgbGlzdDogVHJlZURhdGFbXSA9IFtdO1xuICAgIGZ1bmN0aW9uIGZpbHRlckl0ZW1zKG1lbnVJdGVtczogVHJlZURhdGFbXSkge1xuICAgICAgICBtZW51SXRlbXMgPSBtZW51SXRlbXMuZmlsdGVyKChpdGVtOiBUcmVlRGF0YSkgPT4ge1xuICAgICAgICAgICAgaWYgKGl0ZW0uc2hvdyAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpdGVtLnNob3c7XG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGNvbnN0IG1lbnVJdGVtIG9mIG1lbnVJdGVtcykge1xuICAgICAgICAgICAgbWVudUl0ZW0uY2hpbGRyZW4gPSBmaWx0ZXJJdGVtcyhtZW51SXRlbS5jaGlsZHJlbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lbnVJdGVtcztcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBmaWx0ZXJUcmVlOiBmaWx0ZXJJdGVtcyh0cmVlKSxcbiAgICAgICAgZmlyc3RTZWxlY3Q6IGxpc3RbMF0sXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRNZW51RGF0YShtZW51RGF0YTogTWVudVRlbXBsYXRlSXRlbVtdLCBmb2xkOiBib29sZWFuLCBwYXJlbnQ/OiBUcmVlRGF0YSk6IFRyZWVEYXRhW10ge1xuICAgIHJldHVybiBtZW51RGF0YS5tYXAoKGl0ZW06IE1lbnVUZW1wbGF0ZUl0ZW0pID0+IHtcbiAgICAgICAgY29uc3Qgc3VibWVudSA9IGl0ZW0uc3VibWVudSB8fCBbXTtcbiAgICAgICAgY29uc3QgaXRlbU1lbnU6IFRyZWVEYXRhID0ge1xuICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQgfHwgbnVsbCxcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIGFkZE9wdGlvbnM6IGl0ZW0uYWRkT3B0aW9ucyEsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0ubGFiZWwhLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNob3c6IHRydWUsXG4gICAgICAgICAgICBmb2xkOiBmb2xkLFxuICAgICAgICAgICAgc2hvd0Fycm93OiBzdWJtZW51Lmxlbmd0aCA+IDAsXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXG4gICAgICAgIH07XG4gICAgICAgIGl0ZW1NZW51LmNoaWxkcmVuID0gY29udmVydE1lbnVEYXRhKHN1Ym1lbnUsIGZvbGQsIGl0ZW1NZW51KTtcbiAgICAgICAgcmV0dXJuIGl0ZW1NZW51O1xuICAgIH0pO1xufVxuIl19